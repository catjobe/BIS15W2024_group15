"0","ui <- dashboardPage("
"0","  dashboardHeader(title = ""Dogs and Markers""),"
"0","  dashboardSidebar(disable=T),"
"0","  dashboardBody("
"0","          "
"0","          fluidRow("
"0","  box(title = ""Plot Options"", width = 3,"
"0","  radioButtons(""x"", ""Select Height Category"", choices = c(""small"", ""large""), selected = ""large""),"
"0","  ), #closes the first box"
"0","  box(title = ""Dog Size and Markers"", width = 8,"
"0","  plotOutput(""plot"", width = ""500px"", height = ""400px"")"
"0","  "
"0","  ) #closes the second box"
"0","  ) #closes the row"
"0","  ) #closes the dashboard body"
"0",") #closes the ui "
"0",""
"0","server <- function(input, output, session) {"
"0","        "
"0","        session$onSessionEnded(stopApp)"
"0","        "
"0","        output$plot <- renderPlot ({"
"0","          "
"0","        dog %>%"
"0","        mutate(height_category = case_when(height_cm <= 20.0 ~ ""small"","
"0","                                           height_cm > 20.0 & height_cm < 73.0 ~ ""medium"","
"0","                                           height_cm >= 73.0 ~ ""large"")) %>% "
"0","        filter(height_category == ""small"" | height_category == ""large"") %>% "
"0","        pivot_longer(cols = starts_with(""chr15""),"
"0","                     names_to = ""chr_location"","
"0","                     values_to = ""marker_alleles_data"") %>% "
"0","        filter(height_category == input$x) %>% "
"0","        ggplot(aes(x = chr_location, fill = marker_alleles_data)) +"
"0","        geom_bar() +"
"0","        scale_fill_brewer(palette = ""Spectral"") +"
"0","        theme_minimal() +"
"0","        facet_wrap(breed~.) +"
"0","        labs(title = ""Dogs Compared by Alleles at 10 Positions"","
"0","             x = ""Position"","
"0","             y = ""Count"","
"0","             fill = ""Marker"") +"
"0","        theme(plot.title = element_text(size = rel(1.3), hjust = 0.5), axis.text.x = element_text(angle = 90, hjust = 1))"
"0","        "
"0","})"
"0","        "
"0","}"
"0",""
"0","shinyApp(ui, server)"
"2","
Listening on http://127.0.0.1:5084
"
